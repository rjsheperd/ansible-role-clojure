---
- name: Converge
  hosts: all
  roles:
    - role: geerlingguy.repo-epel
      when: ansible_os_family == "RedHat"
    - role: geerlingguy.java
    - role: ansible-role-clojure

  pre_tasks:
    - name: Update Debian repos
      apt: update_cache=yes
      when: ansible_os_family == "Debian"

  post_tasks:
    - name: Verify Clojure is installed
      command: "/usr/local/bin/clj -Sdescribe"
      changed_when: false

    - name: Verify Leiningen is installed
      command: "/usr/local/bin/lein --version"
      changed_when: false
